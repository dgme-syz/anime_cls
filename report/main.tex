%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Esta es la plantilla oficial para someter artículos a la Revista digital Matemática, Educación e Internet, del Instituto Tecnológico de Costa Rica.
%Esta plantilla sólo le generará el artículo en un formato preliminar, la versión final será editada por el consejo editorial de la revista, luego que se haya pasado el proceso de arbitraje.
%En la carpeta titulada "Paquetes" se encuentran los archivos necesarios para el correcto funcionamiento de la plantilla, por lo que se recomienda no moverlos de lugar ni agregar paquetes nuevos.
%En la carpeta titulada images, se deben incluir las imágenes necesarias para el artículo. Los archivos: logo.pdf, logocc.png y ORCID-ID_icon-16x16.png, son necesarios para el formato egenral del artículo, por favor no eliminarlos.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Carga la clase de la revista, se prefiere la alineación de la ecuaciones a la izquierda, pero si se quiere que salgan centradas entonces quitar el [fleqn]
\documentclass[fleqn]{Paquetes/RevDigMatEduInt}

% El archivo RevDigMatEduIntPreambulo.tex, continene los paquetes ams y algunos otros de símbolos, también los colores y la opción de utilizar varias columnas, se definen además algunos comandos personalizados como los símbolos de los conjuntos y la definición de las funciones sen, arcsen y senh. Si se desea, se puede ver el archivo para saber qué otros comandos están definidos y se pueden utilizar. 
\include{Paquetes/RevDigMatEduIntPreambulo.tex}

% Activar si el artículo incluye gráficos, sino quitar o comentar
\usepackage{graphicx}

% Activa si el artículo incluye subfiguras, sino quitar o comentar
\usepackage{subcaption}

% Incluir si se quieren utilizar los entornos matemáticos: definicion, teorema, proposicion, ejemplo, lema, corolario, vocabulario. Si no se usa entonces quitarlo o comentarlo
% También define un entorno para cajas de color (caja), cajas simples (scaja) y notas (nota)
% Todos se utilizan de la misma forma, se ejemplificará para los teoremas, se puede escribir de las siguientes tres maneras:
% \begin{teorema}  o  \begin{teorema}[de tal]  o  \begin{teorema}[][label]
% En el tercer caso label es el nombre del etiqueta para hacer posteriormente referencia al teorema con \ref{label}
\usepackage{Paquetes/RevDigMatEduIntEntornos}

 % Se debe llenar la información que se indica:
%\usepackage[pdftex,
%			%--------------INFORMACIÓN--------------------------------
%			pdfauthor={Autor 1,Autor 2}, % Sólo el nombre y apellidos de cada autor
%			pdftitle={Título de artículo}, % Título en español
%			pdfsubject={Descripción breve del artículo}, % No es copiar el abstract, sino escribir una descripción muy breve
%			pdfkeywords={palabras clave, keywords}, % Palabras clae en español e inglés 
%			%------------Las siguientes líneas no se deben cambiar--------%
%			pdfcreator={pdflatex},
%			breaklinks,colorlinks=true, pdfstartview=FitV, linkcolor=azulEntornos, citecolor=azulEntornos, urlcolor=azulEntornos]{perref}

\usepackage[breaklinks,colorlinks=true, pdfstartview=FitV, linkcolor=azulEntornos, citecolor=azulEntornos, urlcolor=azulEntornos]{hyperref}
\hypersetup{%
    pdfauthor={Autor 1,Autor 2}, % Sólo el nombre y apellidos de cada autor
	pdftitle={Título de artículo}, % Título en español
	pdfsubject={Descripción breve del artículo}, % No es copiar el abstract, sino escribir una descripción muy breve
	pdfkeywords={palabras clave, keywords}, % Palabras clae en español e inglés 
	%------------Las siguientes líneas no se deben cambiar--------%
}
% Agregar acá todos los paquetes y definiciones personales que de manera adicional se necesiten para el artículo 



% Si el artículo cuenta con código de programación debe agregar el siguiente paquete, caso contrario puede quitarlo o comentarlo. Para su funcionamiento se usa el paquete listings.  
%Actualmente sólo se incluyen los lenguajes: R, Java, cpp, c, python, matlab. Si se utiliza algún otro lenguaje entonces no incluir este paquete y definirlo después (siempre utilizando listings)

\usepackage[Java]{Paquetes/RevDigMatEduIntCodigo}


% Quitar el comentario de las siguientes líneas si se utiliza un archivo de bibtex o biblatex para generar la bibliografía
%\usepackage[babel]{csquotes}
%\usepackage[backend=biber, style=apa, citestyle=apa]{biblatex}
%\DeclareLanguageMapping{spanish}{spanish-apa}
%Archivo desde el cual se está cargando la bibliografía:
%\addbibresource{Biblio.bib}


% Cambiar sólo el título en español y en inglés, el resto de datos lo llenarán los encargados de la revista una vez que se apruebe el artículo
% Orden: T\'itulo en espanol - T\'itulo en ingl\'es - volumen - n\'umero - mes de inicio - mes final - anno
\definecolor{purple1}{HTML}{7F3CFF}
\titulo{\textcolor{azulTitulos}{ 基于 GochiUsa\_Faces数据集分类问题的解决方案}}{}{num}{num}{mes, año}{mes, año}

% Autores del artículo, se permite hasta ocho autores, si son más entonces solicitar una plantilla especial con la cantidad necesaria
% Para cada autor se debe indicar cinco datos:
% Nombre - email - Universidad o institución - País - Número de ORCID
\autor{沈运之}{052110814}{1729990469@qq.com}{}{}
\autordos{黄开奕}{182111510}{1476060622@qq.com}{}{}
\autortres{徐行}{082120109}{1928161381@qq.com}{}{}
%\autorcuatro{Autor 4}{autor4@itcr.ac.cr}{Instituto Tecnológico de Costa Rica}{Costa Rica}{0000-0000-0000-0000}
%\autorcinco{Autor 5}{autor5@itcr.ac.cr}{Instituto Tecnológico de Costa Rica}{Costa Rica}{0000-0000-0000-0000}
%\autorseis{Autor 6}{autor6@itcr.ac.cr}{Instituto Tecnológico de Costa Rica}{Costa Rica}{0000-0000-0000-0000}
%\autorsiete{Autor 7}{autor7@itcr.ac.cr}{Instituto Tecnológico de Costa Rica}{Costa Rica}{0000-0000-0000-0000}
%\autorocho{Autor 8}{autor8@itcr.ac.cr}{Instituto Tecnológico de Costa Rica}{Costa Rica}{0000-0000-0000-0000}

% Imprime los autores (no cambiar)
\autores

% Imprime la fecha de recibido y aceptado, no se debe cambiar, esto se llenará una vez que sea aceptado el artículo
\fecha %Recibido-Aceptado

\begin{document}%-----------------------------------------------------
	% Construye el Pie de p\'agina, poner el título nuevamente y los autores en forma resumida (Apellido, N.)
	\offprintinfo{$\mathrm{NUAA}$·人工智能}{沈运之, 黄开奕, 徐行}
	
	% Hace el título, los autores y las fechas (no cambiar)
	\maketitle


\begin{keywords}
	\textcolor{azulTitulos}{图像分类\ 降维 \ 判别 \ 多因变变量线性回归 \ 假设检验}
\end{keywords}

\section{介绍}
\subsection{概要}
统计学习中，分类问题应该算得上是一个相当经典的模型，大多数方法都可以参与这一问题的解决，基于此，用分类问题来应用多元统计分析所学到的知识再合适不过。

分类问题中，图像分类占据了很大程度的一部分，然后，现实中的图片分类问题要经过传感器获取，以及Jpeg 压缩一系列退化的过程，其一般受噪声影响较为严重，所以我们选择了产生于互联网上的图片，即动漫人物的图片构建我们的分类问题(其实单纯是因为兴趣)。

该图片数据集主要由两个文件夹构成，ANIME 文件夹用于训练，DANBOORU 文件夹用于测试，其中包含 9 个类别，分别是 Blue Mountain，Chino，Chiya，Cocoa，Maya，Megumi，Mocha，Rize，Sharo对应数字 0-8；ANIME 包含 59579 张图片，DANBOORU 包含 9141 张图片，初始文件夹里包含(通道数为 $3$)从 26 $\times $ 26，到 987 $\times$ 987 尺寸不一的图片，为了便于处理，已经经过 python 脚本统一处理为 32 $\times $ 32。原数据集来源于 Kaggle:\href{https://www.kaggle.com/datasets/rignak/gochiusa-faces}{https://www.kaggle.com/datasets/rignak/gochiusa-faces}。

\subsection{解决方案}

首先我们小组成员自行充当分类器，分类效果非常好，因此这个学习问题是理论上可以实现。下面我将阐述这份实验提供的解决方案：

\begin{nota}

\begin{itemize}
	\item 首先观察图片数据的特征是否近似满足正态分布，以及初步构建对于数据认识。
	\item 然后基于先验，选择合适的方法进行降维，并将降至二维进行可视化。
	\item 对于不同的降维结果，使用基于模型的多因变量的线性回归，SVM，以及 model-free 的基于决策树的分类器进行测试，挑选出最好的结果。
	\item 基于以上结果进行分析。
\end{itemize}
\end{nota}

\subsection{符号约定}

为了便于叙述，这里规定 $N$ 为数据集样本数，$M$ 为每个样本的特征，这里定义每个样本的特征为图片张量向量化的结果，$X$ 为 $N \times M$ 的数据矩阵，$Y$ 为 $N \times 1$ 的标签向量，其中 $y_i \in Z \mbox{ and } y_i \in [0,8]$，约定每一个样本为 $X_i^\top = \begin{bmatrix}x_{i1} & \cdots & x_{iM}\end{bmatrix}$，对应标签为 $y_i$，$Y = \begin{bmatrix}y_1&y_2& \cdots & y_N \end{bmatrix}^\top$从而有：

\begin{align}
	X = \begin{bmatrix}
		X_1^\top \\ X_2^\top \\\vdots \\ X_N^\top 
	\end{bmatrix} = \begin{bmatrix}
	x_{11} & x_{12} & \cdots & x_{1M}\\
	x_{21} & x_{22} & \cdots & x_{2M} \\
	\vdots & & &\vdots\\
	x_{N1} & x_{N2} & \cdots & x_{NM}\notag
	\end{bmatrix} 
\end{align}


\section{数据属性}

在对数据进行进一步分析，为了尽可能防止出现数值问题(0-255以内的数字多次线性组合可能会是很大的值)，首先先将数据通过标准化处理调整为均值为0，方差为1，设 $\bar{x}_i$ 为数据矩阵 $X$ 第 $i$ 列的样本均值(也就是随机变量 $X_i$ 的$N$ 次取样)，$\sigma_i$ 为其标准差，于是其内的数据 $x$ 的标准化后的值$\tilde{x}$为:

$$
\tilde{x} = \frac{x - \bar{x}_i}{\sigma_i}
$$

\subsection{类别情况}

首先观察最直观的数据属性，将每个类别在训练集和测试集上的规模画出(见 Figure 1)，训练集内最少的两个类别为 Mocha 与 Blue Mountain 分别有 1241个，1607个，而数量最多的类别 Chino 有 12941 个，倍数达到十倍，该数据集为长尾数据集，原数据集作者说，大部分角色具有明显的特征，因此我们仍然选择这两个类别作为我们分类任务的一环(本质上还是因为这个学习问题不太难)。

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.13]{./images/pic1}
	\caption{各类别训练集与测试集的分类情况，横轴为类别对应的样本数目，且采用对数刻度}
\end{figure}



\subsection{特征相关性}

由于下面要使用线性回归模型，需要先保证数据特征不存在强相关，否则严重的多重共线性将导致线性模型 $C^\top C$ 不满秩，使得线性回归将不存在唯一解，这可能会影响答案的准确性。注意到样本的特征数为 $M = 3072$，设样本协方差阵为 $S$，$V^{1/2} = \mathrm{diag}(\sqrt{S_{11}},  \sqrt{S_{22}},\cdots,\sqrt{S_{MM}})$，相关系数矩阵  $R$ 由以下公式给出:
$$
R = (V^{1/2})^{-1}S(V^{1/2})^{-1}b 
$$

实际计算复杂度为 $N \times M^2$，实际运行却很快，这可能得归功于 numpy 的矩乘优化，统计总计 $3072 \times 3072$个相关系数，绘制其频率(已经划分好分段区间)直方图(参考 Figure 2)

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.33]{./images/pic3}
	\caption{频率直方图，已经将纵坐标 $\log$ 处理了}
\end{figure}

计算得到有多达 136496 对特征具有 $\geq 0.7$ 的相关性(情理之中)，之后的进一步工作可以尝试使用降维方法减少多重共线性，那时再做进一步分析。

\subsubsection{Subsubsección}

%-------------Uso de los entornos-------------%

\begin{definicion}[(Nombre de la definición)]
	Sea $f$ ...
\end{definicion}

\begin{definicion}[][def:dos]
Definición sin nombre ...
\end{definicion}

Ejemplo para hacer referencia a una definición (teorema, corolario, etc), en la definición \ref{def:dos}.

\begin{notacion}
	Notación sin nombre ...
\end{notacion}

\begin{teorema}[(Nombre del teorema)][teo:1]
	Sea $f$ ...
\end{teorema}

\begin{proof}
	Prueba de teorema
\end{proof}

\begin{teorema}
Teorema sin nombre ...
\end{teorema}

En el teorema \ref{teo:1}

\begin{ejemplo}[(Nombre del ejemplo)]
	Sea $f$ ...
\end{ejemplo}

\begin{ejemplo}
	Ejemplo sin nombre ...
\end{ejemplo}

\begin{corolario}[(Nombre del corolario)]
	Sea $f$ ...
\end{corolario}

\begin{corolario}
Corolario sin nombre ...
\end{corolario}

\begin{lema}[(Nombre del lema)]
Sea $f$ ...
\end{lema}

\begin{lema}
Lema si nombre ...
\end{lema}

\begin{nota}[(Nombre de la nota)]
Sea $f$ ...
\end{nota}

\begin{nota}
Nota sin nombre ...
\end{nota}

\begin{vocabulario}[(Nombre del vocabulario)]
Sea $f$ ...
\end{vocabulario}

\begin{vocabulario}
Vocabulario sin nombre ...
\end{vocabulario}

\begin{algoritmo}[(Nombre del algoritmo)]
	Algoritmo con nombre ...
\end{algoritmo}

\begin{observacion}
	Observación sin nombre ...
\end{observacion}

\begin{caja}[(Nombre de la caja)]
Sea $f$ ...
\end{caja}

\begin{scaja}
Scaja sin nombre ...
\end{scaja}

%--------------Uso de figuras y subfiguras--------------%

\begin{figure}[ht!!!]
	\centering
	\begin{minipage}{0.7\textwidth}
		\centering
		\includegraphics[scale=0.2]{images/bowl}
		\caption{Título de la figura. Decir si es elaboración propia o poner referencia.}
		\label{fig:nombre}
	\end{minipage}
\end{figure}

Note cómo en la Figura \ref{fig:nombre} ...

\begin{figure}[ht!!!]
	\centering
	\begin{minipage}{0.7\textwidth}
		\centering
		\begin{subfigure}{0.47\textwidth}
			\centering
			\includegraphics[scale=0.1]{images/bowl}
			\caption{Subfigura 1}
			\label{subfig:1}
		\end{subfigure}
		\begin{subfigure}{0.47\textwidth}
			\centering
			\includegraphics[scale=0.1]{images/bowl}
			\caption{Subfigura 2}
			\label{subfig:2}
		\end{subfigure}
		\caption{ Título para la figura en general. Decir si es elaboración propia o poner referencia.}
		\label{fig:2}
	\end{minipage}
\end{figure}

En la Figura \ref{fig:2}, en la subfigura \ref{subfig:2} se observa que ...

%-----------Uso de tablas---------------%
% Los colores se utilizan sólo como muestra de utilización pero se deben evitar

Puede observar en la Tabla \ref{tabla:nombre} ...

\begin{table}[ht!!!]
	\centering
	\begin{minipage}{0.7\textwidth}
	\caption{Título de la Tabla. Decir si es elaboración propia o poner referencia.}
	\centering
	\begin{tabular}{*5l}    \toprule
		\emph{name} & \emph{foo} & & &  \\ \midrule
		Models    & A  & B  & C  & D  \\ 
		Model $X$ & X1 & X2 & X3 & X4\\ 
		Model $Y$ & Y1 & Y2 & Y3 & Y4\\ \bottomrule
	\end{tabular}
	\label{tabla:nombre}
	\end{minipage}
\end{table}

%--------------Uso de ecuaciones numeradas y no numeradas-----------%

Ecuación numerada:
\begin{equation}
	x=\frac{b\pm \sqrt{b^2-4ac}}{2a}
	\label{eqn:formulaGeneral}
\end{equation}
En la fórmula \ref{eqn:formulaGeneral} ...

Ecuación no numerada:
\begin{equation*}
	x=\frac{b\pm \sqrt{b^2-4ac}}{2a}
\end{equation*}

Ecuación alineada numerada:
\begin{align}
	x & = a^2-b^2 \label{eqn:2}\\
	& = (a-b)(a+b) \label{eqn:3}
\end{align}
En las expresiones \ref{eqn:2} y \ref{eqn:3} ...

Ecuación alineada no numerada:
\begin{align*}
	x & = a^2-b^2 \\
	& = (a-b)(a+b)
\end{align*}

% Para hacer ecuaciones centradas sin numeración también se pueden hacer con \[ \], preferir siempre estas formas sobre $$ $$
Ecuación centrada \[ a^2=b^2+c^2 \]

% Se ejemplifica la introducción de código en Java

Ejemplo de código Java:

\begin{lstlisting}
	/**
	* This is a doc comment.
	*/
	package com.ociweb.jnb.lombok;
	
	import java.util.Date;
	import lombok.Data;
	import lombok.EqualsAndHashCode;
	import lombok.NonNull;
	
	$$@Data
	$$@EqualsAndHashCode(exclude={"address","city","state","zip"})
	public class Person {
		enum Gender { Male, Female }
		
		// another comment
		
		%%@NonNull%% private String firstName;
		%%@NonNull%% private String lastName;
		%%@NonNull%% private final Gender gender;
		%%@NonNull%% private final Date dateOfBirth;
		
		private String ssn;
		private String address;
		private String city;
		private String state;
		private String zip;
	}
\end{lstlisting}

Este es código en la misma línea \lstinline|import java.util.Date;|, el símbolo | es sólo un delimitador y se puede cambiar por algún otro que no se utilice en el código.


%---------------Uso y definición de la bibliografía---------------%
% Poner sólo las referencias bibliográficas, es decir, sólo las que se hayan utilizado en el artículo y revisar que las direcciones web funcionen correctamente

% En el caso de utilizar el ambiente thebibliography
Esta es una cita de la bibliografía: \cite{H}

La bibliografía se prefiere según APA con utilizando biblatex con Biber, también aceptamos el formato IEEE.

% En el caso de utilizar biber
%Esta es una cita de la bibliografía: \parencite{H}

% Quitar el comentario de la siguiente línea si se utilizará biber para generar la bibliografía y quitar todo el ambiente thebibliography
%\printbibliography[heading=bibnumbered]

\begin{thebibliography}{AAAAA}
	\bibitem{H} Cita H
\end{thebibliography}

% Inicia la sección de apéndices
\appendix

\section{Apéndice}

Apéndice

\end{document}

% Consideraciones finales:
%
% -No utilizar hspace, vspace, bigskip, medskip, etc.
% -No utilizar newpage, clearpage, etc.
% -Preferir imágenes vectoriales, en caso contrario asegurarse que se vean lo más claro posible.
% -Preferir que las imágenes y las tablas sean flotantes con [ht] y hacer referencia a la tabla o imágen sobre la opción de tenerlas estáticas. 